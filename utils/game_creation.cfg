#define CAMPAIGN_CREATION_OPTIONS
	{VARIABLE uws_game.map_id 6}
	{VARIABLE uws_game.process_spawn_table yes}
	{VARIABLE allow_predefined yes}
	
	[fire_event]
		name=init_and_replace_map_mask
	[/fire_event]

#	hide the choice since it's only one option
#	[message]
#		speaker=narrator
#		caption="Lord Master of All Wesnoth"
#		image="portraits/uws/razerman.png"
#		message="Welcome to the Quequo's Ultimate Wesnoth Survival Campaign. Before you can begin the game you must choose the campaign first:"
#		[option]
#			message="Return from Captivity - <span color='#37b84c'>5</span> scenarios, total <span color='#37b84c'>164</span> turns"
#			[command]
#				{VARIABLE uws_game.map_id 6}
#				{VARIABLE allow_predefined yes}
#				
#				[fire_event]
#					name=init_and_replace_map_mask
#				[/fire_event]
#			[/command]
#		[/option]
#	[/message]
	
	{VARIABLE uws_game.remove_wall no}
	{VARIABLE uws_game.spawn_hidden_leaders yes}
	{VARIABLE after_games.enable_spawn_copy_debuff no}
	{VARIABLE uws_game.spawn_weak_enemies no}
	
	[switch]
		variable=uws_game.mode
		
		[case]
			value=scroll
			
			{VARIABLE uws_game.scroll normal}
			{VARIABLE uws_game.mode_readable Scroll}
			{VARIABLE uws_game.loyal_units yes}
			{VARIABLE uws_game.is_pvp no}
			{VARIABLE uws_game.is_open_world no}
			{VARIABLE uws_game.win_condition "Get all the way to the end and defeat the Butcher of Wesnoth"}
			{VARIABLE uws_game.objective_notes "You pay no upkeep for your troops, and earn no income from villages.
You can get gold from some enemies or casual treasures.
Letting a unit be reached by the lava means its immediate death.
You will find special areas during your trip, in which you can heal your units or get random upgrades."}
			
			
			[switch]
				variable=uws_game.difficulty_readable
				
				[case]
					value=Easy
					
					{VARIABLE uws_game.difficulty 2}
					{VARIABLE uws_game.buff_modifier 0.5}
					{VARIABLE uws_game.spawn_weak_enemies yes}
					{VARIABLE uws_game.starting_gold 100}
					{VARIABLE uws_game.leader_can_die yes}
					{VARIABLE uws_game.lose_condition "Your army is defeated."}
				[/case]
				
				[case]
					value=Normal
					
					{VARIABLE uws_game.difficulty 2}
					{VARIABLE uws_game.buff_modifier 0.75}
					{VARIABLE uws_game.starting_gold 100}
					{VARIABLE uws_game.leader_can_die yes}
					{VARIABLE uws_game.lose_condition "Your army is defeated."}
				[/case]
				
				[case]
					value=Hard
					
					{VARIABLE uws_game.difficulty 3}
					{VARIABLE uws_game.buff_modifier 1}
					{VARIABLE uws_game.starting_gold 90}
					{VARIABLE uws_game.leader_can_die no}
					{VARIABLE uws_game.lose_condition "Your leader is defeated."}
				[/case]
				
				[case]
					value=Hardcore
					
					{VARIABLE uws_game.difficulty 4}
					{VARIABLE uws_game.buff_modifier 1.25}
					{VARIABLE uws_game.starting_gold 85}
					{VARIABLE uws_game.leader_can_die no}
					{VARIABLE uws_game.lose_condition "Your leader is defeated."}
				[/case]
			[/switch]
			
			[message]
				speaker=narrator
				caption="Scholar of Black Fire"
				image="portraits/uws/tineen.png"
				message="Welcome to the Quequo's Ultimate Wesnoth Survival Campaign. Before you can begin the game you must choose some game settings first. Would you like to gamble with wesnoth RNG? (unit levels are always maintained)"
				[option]
					message="No, give me the predefined enemies, always the same"
					[command]
						{VARIABLE uws_game.random_enemies no}
						{VARIABLE uws_game.full_random no}
					[/command]
					[show_if]
						[variable]
							name=allow_predefined
							boolean_equals=yes
						[/variable]
					[/show_if]
				[/option]
				[option]
					message="Yes, give me random enemies, mirrored for each player"
					[command]
						{VARIABLE uws_game.random_enemies yes}
						{VARIABLE uws_game.full_random no}
					[/command]
				[/option]
				[option]
					message="Full random, each player gets different enemies"
					[command]
						{VARIABLE uws_game.random_enemies yes}
						{VARIABLE uws_game.full_random yes}
					[/command]
				[/option]
			[/message]
			
			[message]
				speaker=narrator
				caption="Ancient Oak of Forgotten Age"
				image="portraits/uws/shaman.png"
				message="Choose between helper labels and fog mode."
				[option]
					message="Labels indicating coming enemies without fog"
					[command]
						{VARIABLE uws_game.fog_mode no}
						{VARIABLE uws_game.minimum_info_labels no}
					[/command]
					
				[/option]
				[option]
					message="Helper labels showing enemy levels with fog"
					[command]
						{VARIABLE uws_game.fog_mode no}
						{VARIABLE uws_game.minimum_info_labels yes}
						
						[modify_side]
							[filter_side]
								side=8,9
							[/filter_side]
							
							fog=yes
						[/modify_side]
					[/command]
					
				[/option]
				[option]
					message="Full fog mode"
					[command]
						{VARIABLE uws_game.fog_mode yes}
						
						[modify_side]
							[filter_side]
								side=8,9
							[/filter_side]
							
							fog=yes
						[/modify_side]
					[/command]
				[/option]
			[/message]
			
			[if]
				[variable]
					name=uws_game.single_player_game
					boolean_equals=yes
				[/variable]
				[then]
					{VARIABLE uws_game.remove_wall no}
				[/then]
				[else]
					[message]
						speaker=narrator
						caption="Undisputed Jungle Spearmaster"
						image="portraits/uws/saurian-alt.png"
						message="What about the wall in between the players?"
						[option]
							message="Keep the wall"
							[command]
								{VARIABLE uws_game.remove_wall no}
							[/command]
						[/option]
						[option]
							message="Remove the wall for a cooperative game"
							[command]
								{VARIABLE uws_game.remove_wall yes}
								{SCROLL_REMOVE_WALL_IF_COOP}
							[/command]
						[/option]
					[/message]
				[/else]
			[/if]
		[/case]
		
		[case]
			value=slash
			
			{VARIABLE uws_game.scroll slow}
			{VARIABLE uws_game.mode_readable "Hack'n Slash"}
			{VARIABLE uws_game.loyal_units yes}
			{VARIABLE uws_game.is_pvp no}
			{VARIABLE uws_game.is_open_world yes}
			{VARIABLE uws_game.win_condition "Get all the way to the end and defeat the Butcher of Wesnoth"}
			{VARIABLE uws_game.objective_notes "You pay no upkeep for your troops, and earn no income from villages.
You can get gold from some enemies or casual treasures.
Letting a unit be reached by the lava means its immediate death.
You will find special areas during your trip, in which you can heal your units or get random upgrades."}
			
			{VARIABLE starting_gold_easy 65}
			{VARIABLE starting_gold_normal 65}
			{VARIABLE starting_gold_hard 60}
			{VARIABLE starting_gold_hardcore 55}
			
			[if]
				[variable]
					name=uws_game.single_player_game
					boolean_equals=yes
				[/variable]
				[then]
					{VARIABLE starting_gold_easy 120}
					{VARIABLE starting_gold_normal 120}
					{VARIABLE starting_gold_hard 110}
					{VARIABLE starting_gold_hardcore 100}
				[/then]
			[/if]
			
			[switch]
				variable=uws_game.difficulty_readable
				
				[case]
					value=Easy
					
					{VARIABLE uws_game.difficulty 4}
					{VARIABLE uws_game.spawn_weak_enemies yes}
					{VARIABLE uws_game.buff_modifier 0.5}
					{VARIABLE uws_game.starting_gold $starting_gold_easy}
					{VARIABLE uws_game.leader_can_die yes}
					{VARIABLE uws_game.lose_condition "Your army is defeated."}
				[/case]
				
				[case]
					value=Normal
					
					{VARIABLE uws_game.difficulty 4}
					{VARIABLE uws_game.buff_modifier 0.75}
					{VARIABLE uws_game.starting_gold $starting_gold_normal}
					{VARIABLE uws_game.leader_can_die yes}
					{VARIABLE uws_game.lose_condition "Your army is defeated."}
				[/case]
				
				[case]
					value=Hard
					
					# hard for slash = 5
					{VARIABLE uws_game.difficulty 5}
					{VARIABLE uws_game.buff_modifier 1}
					{VARIABLE uws_game.starting_gold $starting_gold_hard}
					{VARIABLE uws_game.leader_can_die no}
					{VARIABLE uws_game.lose_condition "Your leader is defeated."}
				[/case]
				
				[case]
					value=Hardcore
					
					# hardcore for slash = 6
					{VARIABLE uws_game.difficulty 6}
					{VARIABLE uws_game.buff_modifier 1.25}
					{VARIABLE uws_game.starting_gold $starting_gold_hardcore}
					{VARIABLE uws_game.leader_can_die no}
					{VARIABLE uws_game.lose_condition "Your leader is defeated."}
				[/case]
			[/switch]
			
			{CLEAR_VARIABLE starting_gold_easy}
			{CLEAR_VARIABLE starting_gold_normal}
			{CLEAR_VARIABLE starting_gold_hard}
			{CLEAR_VARIABLE starting_gold_hardcore}
			
			[if]
				[variable]
					name=allow_predefined
					boolean_equals=yes
				[/variable]
				[then]
					[message]
						speaker=narrator
						caption="Guardian of the Temple of the Moon"
						image="portraits/uws/warg.png"
						message="Welcome to the Quequo's Ultimate Wesnoth Survival Campaign. Before you can begin the game you must choose some game settings first. Would you like to gamble with wesnoth RNG? (unit levels are always maintained)"
						[option]
							message="No, give me the predefined enemies, always the same"
							[command]
								{VARIABLE uws_game.random_enemies no}
								{VARIABLE uws_game.fog_mode no}
								{VARIABLE uws_game.full_random no}
							[/command]
						[/option]
						[option]
							message="Yes, give me random enemies"
							[command]
								{VARIABLE uws_game.random_enemies yes}
								{VARIABLE uws_game.fog_mode no}
								{VARIABLE uws_game.full_random no}
							[/command]
						[/option]
					[/message]
				[/then]
				[else]
					{VARIABLE uws_game.random_enemies yes}
					{VARIABLE uws_game.fog_mode no}
					{VARIABLE uws_game.full_random no}
				[/else]
			[/if]
		[/case]
	[/switch]
	
	{GENERATE_RANK_RELATED_VARIABLES}
	{GENERATE_GAME_DESCRIPTION_AFTER_SETTINGS}
#enddef

#define CAMPAIGN_SCENARIO_PREPARE
	{GENERATE_GAME_DESCRIPTION_AFTER_SETTINGS}
	[fire_event]
		name=init_and_replace_map_mask
	[/fire_event]
#enddef

#define GAME_CREATION_OPTIONS
	{VARIABLE show_random_map_menu no}
	{VARIABLE uws_game.process_spawn_table yes}
		
	[message]
		speaker=narrator
		caption="Lord Master of All Wesnoth"
		image="portraits/uws/razerman.png"
		message="Welcome to the Quequo's Ultimate Wesnoth Survival. Before you can begin the game you must choose the scenario first:"
		[option]
			message="Eastern Shore - <span color='#6cd15c'>22</span> hex turns"
			[command]
				{VARIABLE uws_game.map_id 12}
				{VARIABLE allow_predefined yes}
				
				[fire_event]
					name=init_and_replace_map_mask
				[/fire_event]
			[/command]
			[show_if]
				[variable]
					name=uws_game.mode
					not_equals=after_classic
				[/variable]
			[/show_if]
		[/option]
		[option]
			message="Invaded Forests - <span color='#37b84c'>40</span> hex turns"
			[command]
				{VARIABLE uws_game.map_id 0}
				{VARIABLE allow_predefined yes}
				
				[fire_event]
					name=init_and_replace_map_mask
				[/fire_event]
			[/command]
			[show_if]
				[variable]
					name=uws_game.mode
					not_equals=after_classic
				[/variable]
			[/show_if]
		[/option]
		[option]
			message="Dwarvish Mountains - <span color='#76a349'>48</span> hex turns"
			[command]
				{VARIABLE uws_game.map_id 3}
				{VARIABLE allow_predefined yes}
				
				[fire_event]
					name=init_and_replace_map_mask
				[/fire_event]
			[/command]
			[show_if]
				[variable]
					name=uws_game.mode
					not_equals=after_classic
				[/variable]
			[/show_if]
		[/option]
		[option]
			message="Dimaga Beach - <span color='#c2c938'>55</span> hex turns"
			[command]
				{VARIABLE uws_game.map_id 5}
				{VARIABLE allow_predefined yes}
				
				[fire_event]
					name=init_and_replace_map_mask
				[/fire_event]
			[/command]
			[show_if]
				[variable]
					name=uws_game.mode
					not_equals=after_classic
				[/variable]
			[/show_if]
		[/option]
		[option]
			message="Original TSW - <span color='#cfa438'>60</span> hex turns"
			[command]
				{VARIABLE uws_game.map_id 1}
				{VARIABLE allow_predefined yes}
				
				[fire_event]
					name=init_and_replace_map_mask
				[/fire_event]
			[/command]
			[show_if]
				[variable]
					name=uws_game.mode
					not_equals=after_classic
				[/variable]
			[/show_if]
		[/option]
		[option]
			message="The Great Waters - <span color='#c96c2e'>69</span> hex turns"
			[command]
				{VARIABLE uws_game.map_id 2}
				{VARIABLE allow_predefined yes}
				
				[fire_event]
					name=init_and_replace_map_mask
				[/fire_event]
			[/command]
			[show_if]
				[variable]
					name=uws_game.mode
					not_equals=after_classic
				[/variable]
			[/show_if]
		[/option]
		[option]
			message="Valley of the Necromancer - <span color='#c94f36'>160</span> hex turns"
			[command]
				{VARIABLE uws_game.map_id 4}
				{VARIABLE allow_predefined no}
				
				[fire_event]
					name=init_and_replace_map_mask
				[/fire_event]
			[/command]
			[show_if]
				[variable]
					name=uws_game.mode
					not_equals=after_classic
				[/variable]
			[/show_if]
		[/option]
		[option]
			message="After Classic 1"
			[command]
				{VARIABLE uws_game.map_id 13}
				
				[fire_event]
					name=init_and_replace_map_mask
				[/fire_event]
			[/command]
			[show_if]
				[variable]
					name=uws_game.mode
					equals=after_classic
				[/variable]
			[/show_if]
		[/option]
		[option]
			message="After Classic 2"
			[command]
				{VARIABLE uws_game.map_id 14}
				
				[fire_event]
					name=init_and_replace_map_mask
				[/fire_event]
			[/command]
			[show_if]
				[variable]
					name=uws_game.mode
					equals=after_classic
				[/variable]
			[/show_if]
		[/option]
		[option]
			message="After Classic 3"
			[command]
				{VARIABLE uws_game.map_id 15}
				
				[fire_event]
					name=init_and_replace_map_mask
				[/fire_event]
			[/command]
			[show_if]
				[variable]
					name=uws_game.mode
					equals=after_classic
				[/variable]
			[/show_if]
		[/option]
#		[option]
#			message="Random generated map - host selects length"
#			[command]
#				# TODO remove once the generation code is done
#				{VARIABLE uws_game.map_id 0}
#				# TODO remove once the generation code is done
#				
#				{VARIABLE show_random_map_menu yes}
#			[/command]
#		[/option]
	[/message]
	
	[if]
		[variable]
			name=show_random_map_menu
			boolean_equals=yes
		[/variable]
		[then]
			[message]
				speaker=narrator
				caption="Elf Queen of the Silver Forest"
				image="portraits/uws/elf-mystic.png"
				message="How long you want the mission to be?"
				[option]
					message="Short - 25 turns"
					[command]
						{VARIABLE random_map_length 25}
					[/command]
				[/option]
				[option]
					message="Medium - 40 turns"
					[command]
						{VARIABLE random_map_length 40}
					[/command]
				[/option]
				[option]
					message="Long - 60 turns"
					[command]
						{VARIABLE random_map_length 60}
					[/command]
				[/option]
				[option]
					message="Half-marathon - 80 turns"
					[command]
						{VARIABLE random_map_length 80}
					[/command]
				[/option]
				[option]
					message="Marathon - 160 turns"
					[command]
						{VARIABLE random_map_length 160}
					[/command]
				[/option]
			[/message]
			
			[message]
				speaker=narrator
				caption="Fire Lord of the Black Dune Sultanat"
				image="portraits/uws/tineen.png"
				message="Would you like the Wesnoth RNG to generate the random map seed, or prefer to provide your own?"
				[option]
					message="Generate one for me please"
					[command]
						{VARIABLE generate_random_seed yes}
					[/command]
				[/option]
				[option]
					message="No, I want the map to be generated based on my input"
					[command]
						{VARIABLE generate_random_seed no}
					[/command]
				[/option]
			[/message]
			
			[if]
				[variable]
					name=generate_random_seed
					equals=yes
				[/variable]
				[then]
					# TODO call lua function to generate random seed in sync context
				[/then]
				[else]
					[message]
						speaker=narrator
						caption="Black Bane of Balamour"
						image="portraits/uws/black-cat.png"
						message="Enter 8 alphanumerical characters for the random map seed (case sensitive):"

						[text_input]
							variable=random_map_seed
							label="Seed:"
						[/text_input]
					[/message]
				[/else]
			[/if]
		[/then]
	[/if]
	
	{VARIABLE uws_game.remove_wall no}
	{VARIABLE uws_game.spawn_hidden_leaders yes}
	{VARIABLE after_games.enable_spawn_copy_debuff no}
	{VARIABLE uws_game.spawn_weak_enemies no}
	
	[switch]
		variable=uws_game.mode
		
		[case]
			value=scroll
			
			{VARIABLE uws_game.scroll normal}
			{VARIABLE uws_game.mode_readable Scroll}
			{VARIABLE uws_game.loyal_units yes}
			{VARIABLE uws_game.is_pvp no}
			{VARIABLE uws_game.is_open_world no}
			{VARIABLE uws_game.win_condition "Get all the way to the end and defeat the Butcher of Wesnoth"}
			{VARIABLE uws_game.objective_notes "You pay no upkeep for your troops, and earn no income from villages.
You can get gold from some enemies or casual treasures.
Letting a unit be reached by the lava means its immediate death.
You will find special areas during your trip, in which you can heal your units or get random upgrades."}
			
			[if]
				[variable]
					name=uws_game.single_player_game
					boolean_equals=yes
				[/variable]
				[then]
					{VARIABLE uws_game.remove_wall no}
				[/then]
				[else]
					[message]
						speaker=narrator
						caption="Undisputed Jungle Spearmaster"
						image="portraits/uws/saurian-alt.png"
						message="What about the wall in between the players?"
						[option]
							message="Keep the wall"
							[command]
								{VARIABLE uws_game.remove_wall no}
							[/command]
						[/option]
						[option]
							message="Remove the wall for a cooperative game"
							[command]
								{VARIABLE uws_game.remove_wall yes}
								{SCROLL_REMOVE_WALL_IF_COOP}
							[/command]
						[/option]
					[/message]
				[/else]
			[/if]
			
			[message]
				speaker=narrator
				caption="Eternal Bones of the Nameless One"
				image="portraits/uws/cloaked.png"
				message="Choose your challenge now:"
				[option]
					message="<span color='#90d117'>Easy</span> - weaker enemies, no bonus penalty, 100 gold, leader <span color='#42a83e'>can</span> die"
					[command]
						{VARIABLE uws_game.difficulty_readable Easy}
						{VARIABLE uws_game.difficulty 2}
						{VARIABLE uws_game.spawn_weak_enemies yes}
						{VARIABLE uws_game.buff_modifier 0.5}
						{VARIABLE uws_game.starting_gold 100}
						{VARIABLE uws_game.leader_can_die yes}
						{VARIABLE uws_game.lose_condition "Your army is defeated."}
					[/command]
				[/option]
				[option]
					message="<span color='#f5a720'>Normal</span> - standard enemies, 75% bonus penalty, 100 gold, leader <span color='#42a83e'>can</span> die"
					[command]
						{VARIABLE uws_game.difficulty_readable Normal}
						{VARIABLE uws_game.difficulty 2}
						{VARIABLE uws_game.buff_modifier 0.75}
						{VARIABLE uws_game.starting_gold 100}
						{VARIABLE uws_game.leader_can_die yes}
						{VARIABLE uws_game.lose_condition "Your army is defeated."}
					[/command]
				[/option]
				[option]
					message="<span color='#eb6e2a'>Hard</span> - a few extra enemies, 100% bonus penalty, 90 gold, leader <span color='#f02d26'>must not</span> die"
					[command]
						{VARIABLE uws_game.difficulty_readable Hard}
						{VARIABLE uws_game.difficulty 3}
						{VARIABLE uws_game.buff_modifier 1}
						{VARIABLE uws_game.starting_gold 90}
						{VARIABLE uws_game.leader_can_die no}
						{VARIABLE uws_game.lose_condition "Your leader is defeated."}
					[/command]
				[/option]
				[option]
					message="<span color='#853431'>Hardcore</span> - extra enemies, 125% bonus penalty, 85 gold, leader <span color='#f02d26'>must not</span> die"
					[command]
						{VARIABLE uws_game.difficulty_readable Hardcore}
						{VARIABLE uws_game.difficulty 4}
						{VARIABLE uws_game.buff_modifier 1.25}
						{VARIABLE uws_game.starting_gold 85}
						{VARIABLE uws_game.leader_can_die no}
						{VARIABLE uws_game.lose_condition "Your leader is defeated."}
					[/command]
				[/option]
			[/message]
			
			[message]
				speaker=narrator
				caption="Scholar of Black Fire"
				image="portraits/uws/tineen.png"
				message="Do you also want to gamble with wesnoth RNG? (unit levels are always maintained)"
				[option]
					message="No, give me the predefined enemies, always the same"
					[command]
						{VARIABLE uws_game.random_enemies no}
						{VARIABLE uws_game.full_random no}
					[/command]
					[show_if]
						[variable]
							name=allow_predefined
							boolean_equals=yes
						[/variable]
					[/show_if]
				[/option]
				[option]
					message="Yes, give me random enemies, mirrored for each player"
					[command]
						{VARIABLE uws_game.random_enemies yes}
						{VARIABLE uws_game.full_random no}
					[/command]
				[/option]
				[option]
					message="Full random, each player gets different enemies"
					[command]
						{VARIABLE uws_game.random_enemies yes}
						{VARIABLE uws_game.full_random yes}
					[/command]
				[/option]
			[/message]
			
			[message]
				speaker=narrator
				caption="Ancient Oak of Forgotten Age"
				image="portraits/uws/shaman.png"
				message="Choose between helper labels and fog mode."
				[option]
					message="Labels indicating coming enemies without fog"
					[command]
						{VARIABLE uws_game.fog_mode no}
						{VARIABLE uws_game.minimum_info_labels no}
					[/command]
					
				[/option]
				[option]
					message="Helper labels showing enemy levels with fog"
					[command]
						{VARIABLE uws_game.fog_mode no}
						{VARIABLE uws_game.minimum_info_labels yes}
						
						[modify_side]
							[filter_side]
								side=8,9
							[/filter_side]
							
							fog=yes
						[/modify_side]
					[/command]
					
				[/option]
				[option]
					message="Full fog mode"
					[command]
						{VARIABLE uws_game.fog_mode yes}
						
						[modify_side]
							[filter_side]
								side=8,9
							[/filter_side]
							
							fog=yes
						[/modify_side]
					[/command]
				[/option]
			[/message]
		[/case]
		
		[case]
			value=slash
			
			{VARIABLE uws_game.scroll slow}
			{VARIABLE uws_game.mode_readable "Hack'n Slash"}
			{VARIABLE uws_game.loyal_units yes}
			{VARIABLE uws_game.is_pvp no}
			{VARIABLE uws_game.is_open_world yes}
			{VARIABLE uws_game.win_condition "Get all the way to the end and defeat the Butcher of Wesnoth"}
			{VARIABLE uws_game.objective_notes "You pay no upkeep for your troops, and earn no income from villages.
You can get gold from some enemies or casual treasures.
Letting a unit be reached by the lava means its immediate death.
You will find special areas during your trip, in which you can heal your units or get random upgrades."}
			
			{VARIABLE starting_gold_easy 65}
			{VARIABLE starting_gold_normal 65}
			{VARIABLE starting_gold_hard 60}
			{VARIABLE starting_gold_hardcore 55}
			
			[if]
				[variable]
					name=uws_game.single_player_game
					boolean_equals=yes
				[/variable]
				[then]
					{VARIABLE starting_gold_easy 120}
					{VARIABLE starting_gold_normal 120}
					{VARIABLE starting_gold_hard 110}
					{VARIABLE starting_gold_hardcore 100}
				[/then]
			[/if]
			
			[message]
				speaker=narrator
				caption="Eternal Bones of the Nameless One"
				image="portraits/uws/cloaked.png"
				message="Choose your challenge now:"
				[option]
					message="<span color='#90d117'>Easy</span> - weaker enemies, no bonus penalty, $starting_gold_easy gold, leader <span color='#42a83e'>can</span> die"
					[command]
						{VARIABLE uws_game.difficulty_readable Easy}
						{VARIABLE uws_game.difficulty 4}
						{VARIABLE uws_game.spawn_weak_enemies yes}
						{VARIABLE uws_game.buff_modifier 0.5}
						{VARIABLE uws_game.starting_gold $starting_gold_easy}
						{VARIABLE uws_game.leader_can_die yes}
						{VARIABLE uws_game.lose_condition "Your army is defeated."}
					[/command]
				[/option]
				[option]
					message="<span color='#f5a720'>Normal</span> - standard enemies, 75% handicap, $starting_gold_normal gold, leader <span color='#42a83e'>can</span> die"
					[command]
						{VARIABLE uws_game.difficulty_readable Normal}
						{VARIABLE uws_game.difficulty 4}
						{VARIABLE uws_game.buff_modifier 0.75}
						{VARIABLE uws_game.starting_gold $starting_gold_normal}
						{VARIABLE uws_game.leader_can_die yes}
						{VARIABLE uws_game.lose_condition "Your army is defeated."}
					[/command]
				[/option]
				[option]
					message="<span color='#eb6e2a'>Hard</span> - a few extra enemies, 100% handicap, $starting_gold_hard gold, leader <span color='#f02d26'>must not</span> die"
					[command]
						{VARIABLE uws_game.difficulty_readable Hard}
						# hard for slash = 5
						{VARIABLE uws_game.difficulty 5}
						{VARIABLE uws_game.buff_modifier 1}
						{VARIABLE uws_game.starting_gold $starting_gold_hard}
						{VARIABLE uws_game.leader_can_die no}
						{VARIABLE uws_game.lose_condition "Your leader is defeated."}
					[/command]
				[/option]
				[option]
					message="<span color='#853431'>Hardcore</span> - extra enemies, 125% handicap, $starting_gold_hardcore gold, leader <span color='#f02d26'>must not</span> die"
					[command]
						{VARIABLE uws_game.difficulty_readable Hardcore}
						# hardcore for slash = 6
						{VARIABLE uws_game.difficulty 6}
						{VARIABLE uws_game.buff_modifier 1.25}
						{VARIABLE uws_game.starting_gold $starting_gold_hardcore}
						{VARIABLE uws_game.leader_can_die no}
						{VARIABLE uws_game.lose_condition "Your leader is defeated."}
					[/command]
				[/option]
			[/message]
			
			{CLEAR_VARIABLE starting_gold_easy}
			{CLEAR_VARIABLE starting_gold_normal}
			{CLEAR_VARIABLE starting_gold_hard}
			{CLEAR_VARIABLE starting_gold_hardcore}
			
			[message]
				speaker=narrator
				caption="Guardian of the Temple of the Moon"
				image="portraits/uws/warg.png"
				message="Do you also want to gamble with wesnoth RNG? (unit levels are always maintained)"
				[option]
					message="No, give me the predefined enemies, always the same"
					[command]
						{VARIABLE uws_game.random_enemies no}
						{VARIABLE uws_game.fog_mode no}
						{VARIABLE uws_game.full_random no}
					[/command]
					[show_if]
						[variable]
							name=allow_predefined
							boolean_equals=yes
						[/variable]
					[/show_if]
				[/option]
				[option]
					message="Yes, give me random enemies"
					[command]
						{VARIABLE uws_game.random_enemies yes}
						{VARIABLE uws_game.fog_mode no}
						{VARIABLE uws_game.full_random no}
					[/command]
				[/option]
			[/message]
		[/case]
		
		[case]
			value=race
			
			{VARIABLE uws_game.scroll slow}
			{VARIABLE uws_game.mode_readable Race}
			{VARIABLE uws_game.loyal_units no}
			{VARIABLE uws_game.is_pvp yes}
			{VARIABLE uws_game.is_open_world yes}
			{VARIABLE uws_game.win_condition "Race to the top and be te first to capture the flag"}
			{VARIABLE uws_game.objective_notes "You receive gold from villages and all recruited units cost upkeep.
You can get additional gold from some enemies or casual treasures.
Letting a unit be reached by the lava means its immediate death.
You will find special areas during your trip, in which you can heal your units or get random upgrades."}
					
			[message]
				speaker=narrator
				caption="Eternal Bones of the Nameless One"
				image="portraits/uws/cloaked.png"
				message="Choose your challenge now:"
				[option]
					message="<span color='#90d117'>Easy</span> - weaker enemies, no bonus penalty, leader <span color='#42a83e'>can</span> die"
					[command]
						{VARIABLE uws_game.difficulty_readable Easy}
						{VARIABLE uws_game.difficulty 3}
						{VARIABLE uws_game.spawn_weak_enemies yes}
						{VARIABLE uws_game.buff_modifier 0.5}
						{VARIABLE uws_game.leader_can_die yes}
						{VARIABLE uws_game.lose_condition "Your army is defeated."}
					[/command]
				[/option]
				[option]
					message="<span color='#f5a720'>Normal</span> - standard enemies, 75% handicap, leader <span color='#42a83e'>can</span> die"
					[command]
						{VARIABLE uws_game.difficulty_readable Normal}
						{VARIABLE uws_game.difficulty 3}
						{VARIABLE uws_game.buff_modifier 0.75}
						{VARIABLE uws_game.leader_can_die yes}
						{VARIABLE uws_game.lose_condition "Your army is defeated."}
					[/command]
				[/option]
				[option]
					message="<span color='#eb6e2a'>Hard</span> - a few extra enemies, 100% handicap, leader <span color='#f02d26'>must not</span> die"
					[command]
						{VARIABLE uws_game.difficulty_readable Hard}
						# hard for race = 4
						{VARIABLE uws_game.difficulty 4}
						{VARIABLE uws_game.buff_modifier 1}
						{VARIABLE uws_game.leader_can_die no}
						{VARIABLE uws_game.lose_condition "Your leader is defeated."}
					[/command]
				[/option]
				[option]
					message="<span color='#853431'>Hardcore</span> - extra enemies, 125% handicap, leader <span color='#f02d26'>must not</span> die"
					[command]
						{VARIABLE uws_game.difficulty_readable Hardcore}
						# hardcore for race = 5
						{VARIABLE uws_game.difficulty 5}
						{VARIABLE uws_game.buff_modifier 1.25}
						{VARIABLE uws_game.leader_can_die no}
						{VARIABLE uws_game.lose_condition "Your leader is defeated."}
					[/command]
				[/option]
			[/message]
			
			[message]
				speaker=narrator
				caption="Elite Marksman of the Royal Hall"
				image="portraits/uws/crossbowman.png"
				message="How much starting gold should both players receive?"
				[option]
					message="<span color='#90d117'>Plenty</span> - 120 starting gold for a fast paced game"
					[command]
						{VARIABLE uws_game.starting_gold 120}
					[/command]
				[/option]
				[option]
					message="<span color='#f5a720'>Normal</span> - 75 starting gold regular game"
					[command]
						{VARIABLE uws_game.starting_gold 75}
					[/command]
				[/option]
				[option]
					message="<span color='#eb6e2a'>Low</span> - 30 starting gold challenge"
					[command]
						{VARIABLE uws_game.starting_gold 30}
					[/command]
				[/option]
			[/message]
			
			[message]
				speaker=narrator
				caption="Guardian of the Temple of the Moon"
				image="portraits/uws/warg.png"
				message="Do you also want to gamble with wesnoth RNG? (unit levels are always maintained)"
				[option]
					message="No, give me the predefined enemies, always the same"
					[command]
						{VARIABLE uws_game.random_enemies no}
						{VARIABLE uws_game.fog_mode no}
						{VARIABLE uws_game.full_random no}
					[/command]
					[show_if]
						[variable]
							name=allow_predefined
							boolean_equals=yes
						[/variable]
					[/show_if]
				[/option]
				[option]
					message="Yes, give me random enemies, mirrored for each player"
					[command]
						{VARIABLE uws_game.random_enemies yes}
						{VARIABLE uws_game.fog_mode no}
						{VARIABLE uws_game.full_random no}
					[/command]
				[/option]
				[option]
					message="Full random, each player gets different enemies"
					[command]
						{VARIABLE uws_game.random_enemies yes}
						{VARIABLE uws_game.fog_mode no}
						{VARIABLE uws_game.full_random yes}
					[/command]
				[/option]
			[/message]
		[/case]
		
		[case]
			value=after_classic
			
			{VARIABLE uws_game.scroll none}
			{VARIABLE uws_game.process_spawn_table no}
			{VARIABLE uws_game.mode_readable "PvP Survival"}
			{VARIABLE uws_game.loyal_units no}
			{VARIABLE uws_game.is_pvp yes}
			{VARIABLE uws_game.is_open_world no}
			{VARIABLE uws_game.win_condition "Survive the waves of enemies longer than your opponent"}
			{VARIABLE uws_game.objective_notes "You receive gold from villages and all recruited units cost upkeep.
Every few turns a new wave of enemies spawn. Survive as long as you can."}
			{VARIABLE uws_game.lose_condition "Your leader is defeated."}
			{VARIABLE uws_game.spawn_hidden_leaders no}
			{VARIABLE after_games.enable_spawn_copy_debuff yes}
			{VARIABLE uws_game.leader_can_die no}
			{VARIABLE uws_game.starting_gold 80}
			
			# replace with the message/option below
			{VARIABLE after_games.spawn_pattern copies}
			
#			[message]
#				speaker=narrator
#				caption="Swordmaster of the Southern Lands"
#				image="portraits/uws/southern-lord.png"
#				message="Select enemy spawn pattern"
#				[option]
#					message="Copies only"
#					[command]
#						{VARIABLE after_games.spawn_pattern copies}
#					[/command]
#				[/option]
#				[option]
#					message="Waves only, mirrored random"
#					[command]
#						{VARIABLE after_games.spawn_pattern random}
#					[/command]
#				[/option]
#				[option]
#					message="Waves only, full random"
#					[command]
#						{VARIABLE after_games.spawn_pattern random}
#					[/command]
#				[/option]
#				[option]
#					message="Copies and waves, mirrored random"
#					[command]
#						{VARIABLE after_games.spawn_pattern random}
#					[/command]
#				[/option]
#				[option]
#					message="Copies and waves, full random"
#					[command]
#						{VARIABLE after_games.spawn_pattern random}
#					[/command]
#				[/option]
#				[option]
#					message="Copies and waves, players choose"
#					[command]
#						{VARIABLE after_games.spawn_pattern choice}
#					[/command]
#				[/option]
#			[/message]

			[message]
				speaker=narrator
				caption="The All-Seeing Creep"
				image="portraits/uws/watcher.png"
				message="Fog or no fog?"
				[option]
					message="Fog, let's be sneaky"
					[command]
						{VARIABLE uws_game.fog_mode yes}
					[/command]
				[/option]
				[option]
					message="No fog, full visibility"
					[command]
						{VARIABLE uws_game.fog_mode no}
						
						[modify_side]
							[filter_side]
								side=8,9
							[/filter_side]
							
						       	fog=no
						[/modify_side]
					[/command]
				[/option]
			[/message]
		[/case]
		
		[case]
			value=after_race
			
			{VARIABLE uws_game.leader_can_die no}
			{VARIABLE uws_game.starting_gold 80}
			
			[message]
				speaker=narrator
				caption="Master Horseman at Royal Stables"
				image="portraits/uws/horse-lancer.png"
				message="Race spawn frequency"
				[option]
					message="Easy, every 9 hexes"
					[command]
						{VARIABLE after_games.spawn_frequency 9}
					[/command]
				[/option]
				[option]
					message="Medium, every 7 hexes"
					[command]
						{VARIABLE after_games.spawn_frequency 7}
					[/command]
				[/option]
				[option]
					message="Hard, every 5 hexes"
					[command]
						{VARIABLE after_games.spawn_frequency 5}
					[/command]
				[/option]
			[/message]
			
			[message]
				speaker=narrator
				caption="Protector of the Cementery Gates"
				image="portraits/uws/dspearman.png"
				message="Select enemy spawn pattern"
				[option]
					message="Copies only"
					[command]
						{VARIABLE after_games.spawn_pattern copies}
					[/command]
				[/option]
				[option]
					message="Copies and waves, all random"
					[command]
						{VARIABLE after_games.spawn_pattern random}
					[/command]
				[/option]
				[option]
					message="Copies and waves, players choose"
					[command]
						{VARIABLE after_games.spawn_pattern choice}
					[/command]
				[/option]
			[/message]
		[/case]
	[/switch]
	
	{GENERATE_RANK_RELATED_VARIABLES}
	{GENERATE_GAME_DESCRIPTION_AFTER_SETTINGS}
#enddef

#define GENERATE_GAME_DESCRIPTION_AFTER_SETTINGS
	[lua]
	    code = <<
	        local version = wesnoth.get_variable('awss_version')
	        local is_campaign = wesnoth.get_variable('uws_is_campaign')
	        local random_waves = wesnoth.get_variable("uws_game.random_enemies")
	        local fog_mode = wesnoth.get_variable("uws_game.fog_mode")
	        local minimum_info_labels = wesnoth.get_variable("uws_game.minimum_info_labels")
	        local full_random = wesnoth.get_variable("uws_game.full_random")
	        local difficulty = wesnoth.get_variable("uws_game.difficulty_readable")
	        local leader = wesnoth.get_variable("uws_game.leader_can_die")
	        local game_mode = wesnoth.get_variable("uws_game.mode")
	        local mode_readable = wesnoth.get_variable("uws_game.mode_readable")
	        local after_games_spawn_patter = wesnoth.get_variable("after_games.spawn_pattern")
	        local after_race_frequency = wesnoth.get_variable("after_games.spawn_frequency")
	        local map_info = wesnoth.get_variable("uws_game.name")
	        local allow_ae = wesnoth.get_variable("random_pool.allow_ae")
	        local allow_wotg = wesnoth.get_variable("random_pool.allow_wotg")
	        local rol_units = wesnoth.get_variable("random_pool.allow_rol")
	        local eoma_units = wesnoth.get_variable("random_pool.allow_eoma")
	        local info_data = ''
	        local wave_mode_all = { 'Default', }
	        
	        local fog_mode_str = 'no'
	        if fog_mode == true then
	        	fog_mode_str = 'yes'
	        elseif minimum_info_labels == true then
	        	fog_mode_str = 'levels only'
	        end
	        
	        local randomised_str = 'no'
	        if random_waves == true then
	        	if full_random == true then
	 			randomised_str = 'full random'
	 		else
	 			if game_mode == 'slash' then
	 				randomised_str = 'yes'
	 			else
	 				randomised_str = 'mirrored random'
	 			end
	 		end
	        end
	        
	        local leader_str = 'no'
	        if leader == true then
	        	leader_str = 'yes'
	        end
	        
	        if allow_ae then
	        	table.insert(wave_mode_all, 'Ageless')
	       	end
	       	
	        if allow_wotg then
	        	table.insert(wave_mode_all, 'WotG')
	        end
	        
	        if rol_units then
	        	table.insert(wave_mode_all, 'Reign of Lords')
	        end
	        
	        if eoma_units then
	        	table.insert(wave_mode_all, 'EoMa')
	        end
	        
	        local after_spawns_str = ''
	        if after_games_spawn_patter == 'copies' then
	        	after_spawns_str = 'Copies only'
	        elseif after_games_spawn_patter == 'random' then
	        	after_spawns_str = 'Random'
	        else
	        	after_spawns_str = 'Players choice'
	        end
	        
	        if game_mode == 'after_race' then
	        	after_spawns_str = after_spawns_str .. ' (every ' .. after_race_frequency .. ' hexes)'
	        end
	        
	        local mod_name = "Quequo's Ultimate Wesnoth Survival v." .. version
	        local game_settings = 'Map: ' .. map_info .. ' | Game mode: ' .. mode_readable .. ' | Spawn: ' .. table.concat(wave_mode_all, ', ')
	        local map_settings = ''
	        if game_mode == 'scroll' or game_mode == 'race' or game_mode == 'slash' then
	        	map_settings = 'Challenge: ' .. difficulty .. ' | Leader can die: ' .. leader_str  .. ' | Randomised waves: ' .. randomised_str
	        	
	        	if game_mode == 'scroll' then
	        		map_settings = map_settings .. ' | Fog mode: ' .. fog_mode_str
	        	end	
	        else
	        	map_settings = 'Leader can die: ' .. leader_str  .. ' | Spawns: ' .. after_spawns_str .. ' | Fog mode: ' .. fog_mode_str
	        end
	        
	        wesnoth.interface.add_chat_message(mod_name, game_settings)
	        wesnoth.interface.add_chat_message(mod_name, map_settings)
	        
	        if random_waves == true then
	        	local random_pool_str = "Random pool: " .. wesnoth.get_variable("random_pool.count_0") .. "(lvl0), "
	        	random_pool_str = random_pool_str .. wesnoth.get_variable("random_pool.count_1") .. "(lvl1), "
	        	random_pool_str = random_pool_str .. wesnoth.get_variable("random_pool.count_2") .. "(lvl2), "
	        	random_pool_str = random_pool_str .. wesnoth.get_variable("random_pool.count_3") .. "(lvl3), "
	        	random_pool_str = random_pool_str .. wesnoth.get_variable("random_pool.count_4") .. "(lvl4), "
	        	random_pool_str = random_pool_str .. wesnoth.get_variable("random_pool.count_5") .. "(lvl5), "
	        	random_pool_str = random_pool_str .. wesnoth.get_variable("random_pool.count_6") .. "(lvl6), "
	        	random_pool_str = random_pool_str .. wesnoth.get_variable("random_pool.count_7") .. "(lvl7) "
	        	random_pool_str = random_pool_str .. " *TOTAL*=" .. wesnoth.get_variable("random_pool.all_count")
	        	
	        	wesnoth.interface.add_chat_message(mod_name, random_pool_str)
	        end
	        
	        info_data = game_settings .. '\
' .. map_settings

		if is_campaign then
			wesnoth.interface.add_chat_message(mod_name, "The UWS Campaign is in it's alpha release. Some bugs may be present and things may not work as expected. Please message quequo if things are not working.")
		end
	        
	        wesnoth.set_variable('game_info_data', info_data)
	    >>
	[/lua]
	
	[objectives]
		summary="The lava is going upward, run away from it!"
		[objective]
			description=$uws_game.win_condition
			condition=win
		[/objective]
		[objective]
			description=$uws_game.lose_condition
			condition=lose
		[/objective]

		[note]
			description=$uws_game.objective_notes
		[/note]
		note="
<span color='#9999FF'>Created by quequo  (Version {AWSS_VERSION})</span>
Big thanks to IPS, MasterChi3f, Rudko44 and zen-cat for all the help with testing and balancing."
	[/objectives]
#enddef


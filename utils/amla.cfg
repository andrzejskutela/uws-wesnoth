#define QQUWS_APPLY_UWS_AMLA_MODIFICATION
	[event]
		name=post advance
		first_time_only=no

		[filter]
			side=$uws_game.filter_human_sides
			[not]
				[filter_wml]
					[variables]
						has_uws_amla_defined=yes
					[/variables]
				[/filter_wml]
			[/not]
		[/filter]

		[fire_event]
			name=apply_uws_amla_mod
			[primary_unit]
				id=$unit.id
			[/primary_unit]
		[/fire_event]
	[/event]

	[event]
		name=apply_uws_amla_mod
		first_time_only=no

		[if]
			[have_unit]
				id=$unit.id
				formula="if(not advances_to, 1, 0)"
			[/have_unit]
			[then]
				{UWS_AMLA_PRECHECK_UNIT}
				{ADD_DEFAULT_UWS_AMLA}

				[qquws_generate_random_amla_list]
					list_var=uws_amla_list
				[/qquws_generate_random_amla_list]

				[set_variables]
					name=amla_keys
					mode=replace
					[split]
						list=$uws_amla_list
						key=key
						separator=","
						remove_empty=yes
					[/split]
				[/set_variables]

				[foreach]
					array=amla_keys
					variable=amla_buff
					readonly=yes
					
					[do]
						[if]
							[variable]
								name=amla_buff.key
								not_equals=""
							[/variable]
							[then]
								{ADD_UWS_AMLA_MOD}
							[/then]
						[/if]
					[/do]
				[/foreach]
			[/then]
		[/if]
	[/event]
#enddef

#define UWS_AMLA_PRECHECK_UNIT
	[set_variables]
		name=qquws_amla_data
		mode=replace
		[value]
			level=$unit.level
			has_ranged_attack=no
			has_melee_attack=no
			has_magical_melee=no
			has_magical_ranged=no
			has_steadfast=no
			is_fast=no
			has_default_regenerates=no
			is_strong=no
			is_dextrous=no
			is_quick=no
			is_resilient=no
			is_intelligent=no
			is_healthy=no
			is_undead=no
			is_mechanical=no
			is_elemental=no
			is_human=no
		[/value]
	[/set_variables]
	
	[if]
		[have_unit]
			id=$unit.id
			[has_attack]
				formula="if(range='ranged' and damage > 6, 1, 0)"
			[/has_attack]
			count=1
		[/have_unit]
		[then]
			{VARIABLE qquws_amla_data.has_ranged_attack yes}
		[/then]
	[/if]
	
	[if]
		[have_unit]
			id=$unit.id
			[has_attack]
				formula="if(range='melee' and damage > 6, 1, 0)"
			[/has_attack]
			count=1
		[/have_unit]
		[then]
			{VARIABLE qquws_amla_data.has_melee_attack yes}
		[/then]
	[/if]
	
	[if]
		[have_unit]
			id=$unit.id
			[has_attack]
				range=melee
				special_id=magical
			[/has_attack]
			count=1
		[/have_unit]
		[then]
			{VARIABLE qquws_amla_data.has_magical_melee yes}
		[/then]
	[/if]

	[if]
		[have_unit]
			id=$unit.id
			[has_attack]
				range=ranged
				special_id=magical
			[/has_attack]
			count=1
		[/have_unit]
		[then]
			{VARIABLE qquws_amla_data.has_magical_ranged yes}
		[/then]
	[/if]

	[if]
		[have_unit]
			id=$unit.id
			ability=steadfast
			count=1
		[/have_unit]
		[then]
			{VARIABLE qquws_amla_data.has_steadfast yes}
		[/then]
	[/if]

	[if]
		[variable]
			name=$unit.max_moves
			greater_than=8
		[/variable]
		[then]
			{VARIABLE qquws_amla_data.is_fast yes}
		[/then]
	[/if]

	[if]
		[have_unit]
			id=$unit.id
			ability=regenerates,AE_mag_regenerates8,eoma_regenerates8
			count=1
		[/have_unit]
		[then]
			{VARIABLE qquws_amla_data.has_default_regenerates yes}
		[/then]
	[/if]

	[if]
		[have_unit]
			id=$unit.id
			trait=strong
			count=1
		[/have_unit]
		[then]
			{VARIABLE qquws_amla_data.is_strong yes}
		[/then]
	[/if]

	[if]
		[have_unit]
			id=$unit.id
			trait=dextrous
			count=1
		[/have_unit]
		[then]
			{VARIABLE qquws_amla_data.is_dextrous yes}
		[/then]
	[/if]

	[if]
		[have_unit]
			id=$unit.id
			trait=quick
			count=1
		[/have_unit]
		[then]
			{VARIABLE qquws_amla_data.is_quick yes}
		[/then]
	[/if]

	[if]
		[have_unit]
			id=$unit.id
			trait=resilient
			count=1
		[/have_unit]
		[then]
			{VARIABLE qquws_amla_data.is_resilient yes}
		[/then]
	[/if]

	[if]
		[have_unit]
			id=$unit.id
			trait=intelligent
			count=1
		[/have_unit]
		[then]
			{VARIABLE qquws_amla_data.is_intelligent yes}
		[/then]
	[/if]

	[if]
		[have_unit]
			id=$unit.id
			trait=healthy
			count=1
		[/have_unit]
		[then]
			{VARIABLE qquws_amla_data.is_healthy yes}
		[/then]
	[/if]

	[if]
		[have_unit]
			id=$unit.id
			trait=undead
			count=1
		[/have_unit]
		[then]
			{VARIABLE qquws_amla_data.is_undead yes}
		[/then]
	[/if]

	[if]
		[have_unit]
			id=$unit.id
			trait=mechanical
			count=1
		[/have_unit]
		[then]
			{VARIABLE qquws_amla_data.is_mechanical yes}
		[/then]
	[/if]

	[if]
		[have_unit]
			id=$unit.id
			trait=elemental
			count=1
		[/have_unit]
		[then]
			{VARIABLE qquws_amla_data.is_elemental yes}
		[/then]
	[/if]

	[if]
		[have_unit]
			id=$unit.id
			race=human,AE_efm_imperialists_race
			count=1
		[/have_unit]
		[then]
			{VARIABLE qquws_amla_data.is_human yes}
		[/then]
	[/if]
#enddef

#define ADD_UWS_AMLA_MOD
	[switch]
		variable=amla_buff.key
		[case]
			value=REGEN
			
			{AMLA_MOD_UNIT uws_amla_regen_1 1 25 "Regen +10" "icons/herb-bag.png" (
				[effect]
					apply_to=remove_ability
					[abilities]
						[regenerate]
							id=regenerates
						[/regenerate]
						[regenerate]
							id=AE_mag_regenerates8
						[/regenerate]
						[regenerate]
							id=eoma_regenerates8
						[/regenerate]
					[/abilities]
				[/effect]
				[effect]
				    apply_to=new_ability
				    [abilities]
						[regenerate]
							value=10
							id=amla_regenerates
							name="regenerates 10"
							description="The unit will heal itself 10hp per turn. If it is poisoned, it will remove the poison instead of healing."
							affect_self=yes
							poison=cured
						[/regenerate]
				    [/abilities]
				[/effect]
			)}

			{AMLA_MOD_UNIT uws_amla_regen_2 1 30 "Regen +12" "icons/herb-bag.png" (
				require_amla=uws_amla_regen_1
				[effect]
					apply_to=remove_ability
					[abilities]
						[regenerate]
							id=amla_regenerates
						[/regenerate]
					[/abilities]
				[/effect]
				[effect]
				    apply_to=new_ability
				    [abilities]
						[regenerate]
							value=12
							id=amla_regenerates
							name="regenerates 12"
							description="The unit will heal itself 12hp per turn. If it is poisoned, it will remove the poison instead of healing."
							affect_self=yes
							poison=cured
						[/regenerate]
				    [/abilities]
				[/effect]
			)}
		[/case]

		[case]
			value=MINI_REG
			
			{AMLA_MOD_UNIT uws_amla_mini_regen 1 15 "Regen +4" "icons/herb-bag.png" (
				[effect]
					apply_to=remove_ability
					[abilities]
						[regenerate]
							id=regenerates
						[/regenerate]
						[regenerate]
							id=AE_mag_regenerates8
						[/regenerate]
						[regenerate]
							id=eoma_regenerates8
						[/regenerate]
					[/abilities]
				[/effect]
				[effect]
				    apply_to=new_ability
				    [abilities]
						[regenerate]
							value=4
							id=amla_mini_regenerates
							name="regenerates 4"
							description="The unit will heal itself 4hp per turn. If it is poisoned, it will remove the poison instead of healing."
							affect_self=yes
							poison=cured
						[/regenerate]
				    [/abilities]
				[/effect]
			)}
		[/case]

		[case]
			value=R_DMG
			
			{AMLA_MOD_UNIT uws_amla_ranged_dmg 3 20 "Ranged dmg +8%" "icons/hat-huntsman.png" (
				[effect]
				    apply_to=attack
				    range=ranged
				    increase_damage=8%
				[/effect]
			)}
		[/case]

		[case]
			value=R_STR
			
			{AMLA_MOD_UNIT uws_amla_ranged_strike_1 1 40 "Ranged strike (defense)" "icons/hat-huntsman.png" (
				[effect]
				    apply_to=attack
				    range=ranged
				    [set_specials]
				    	mode=append
						[attacks]
							id=qquws_fast_reflex
							name="fast reflex"
							description="Adds 1 strike when defending."
							active_on=offense
							add=1
						[/attacks]
				    [/set_specials]
				[/effect]
			)}

			{AMLA_MOD_UNIT uws_amla_ranged_strike_2 1 25 "Ranged strike (always)" "icons/hat-huntsman.png" (
				require_amla=uws_amla_ranged_strike_1
				[effect]
				    apply_to=attack
				    range=ranged
				    remove_specials=qquws_fast_reflex
				    increase_attacks=1
				[/effect]
			)}
		[/case]

		[case]
			value=R_MAG_ACC
			
			{AMLA_MOD_UNIT uws_amla_ranged_mag_acc_1 1 50 "Ranged magical 75%" "icons/ring_gold.png" (
				[effect]
				    apply_to=attack
				    range=ranged
				    special_id=magical
				    remove_specials=magical
				    [set_specials]
				    	mode=append
						[chance_to_hit]
					        id=magical
					        name="magical 75%"
					        description="This attack always has a 75% chance to hit regardless of the defensive ability of the unit being attacked."
					        value=75
					        cumulative=no
					    [/chance_to_hit]
				    [/set_specials]
				[/effect]
			)}

			{AMLA_MOD_UNIT uws_amla_ranged_mag_acc_2 1 75 "Ranged magical 80%" "icons/ring_gold.png" (
				require_amla=uws_amla_ranged_mag_acc_1
				[effect]
				    apply_to=attack
				    range=ranged
				    special_id=magical
				    remove_specials=magical
				    [set_specials]
				    	mode=append
						[chance_to_hit]
					        id=magical
					        name="magical 80%"
					        description="This attack always has a 80% chance to hit regardless of the defensive ability of the unit being attacked."
					        value=80
					        cumulative=no
					    [/chance_to_hit]
				    [/set_specials]
				[/effect]
			)}
		[/case]

		[case]
			value=R_ACC
			
			{AMLA_MOD_UNIT uws_amla_ranged_acc_1 1 16 "Ranged accuracy +2%" "icons/hat-huntsman.png" (
				[effect]
				    apply_to=attack
				    range=ranged
				    [not]
				    	special_id=magical,AE_mag_magical_defensive,AE_mag_magical_offensive,AE_mag_precision,AE_mag_enchanted,AE_mag_precision_offensive,AE_fut_ubiquitous,eoma_precision,eoma_enchanted,eoma_magical_offensive,eoma_magical_defensive,eoma_precision_offensive
				    [/not]
				    increase_accuracy=2
				[/effect]
			)}

			{AMLA_MOD_UNIT uws_amla_ranged_mag_acc_2 1 24 "Ranged accuracy +3%" "icons/hat-huntsman.png" (
				require_amla=uws_amla_ranged_acc_1
				[effect]
				    apply_to=attack
				    range=ranged
				    [not]
				    	special_id=magical,AE_mag_magical_defensive,AE_mag_magical_offensive,AE_mag_precision,AE_mag_enchanted,AE_mag_precision_offensive,AE_fut_ubiquitous,eoma_precision,eoma_enchanted,eoma_magical_offensive,eoma_magical_defensive,eoma_precision_offensive
				    [/not]
				    increase_accuracy=3
				[/effect]
			)}

			{AMLA_MOD_UNIT uws_amla_ranged_mag_acc_3 1 40 "Ranged accuracy +5%" "icons/hat-huntsman.png" (
				require_amla=uws_amla_ranged_acc_2
				[effect]
				    apply_to=attack
				    range=ranged
				    [not]
				    	special_id=magical,AE_mag_magical_defensive,AE_mag_magical_offensive,AE_mag_precision,AE_mag_enchanted,AE_mag_precision_offensive,AE_fut_ubiquitous,eoma_precision,eoma_enchanted,eoma_magical_offensive,eoma_magical_defensive,eoma_precision_offensive
				    [/not]
				    increase_accuracy=5
				[/effect]
			)}
		[/case]

		[case]
			value=R_PAR
			
			{AMLA_MOD_UNIT uws_amla_ranged_parry 1 30 "Ranged parry +5%" "icons/hat-huntsman.png" (
				[effect]
				    apply_to=attack
				    range=ranged
				    [not]
				    	special_id=magical,AE_mag_magical_defensive,AE_mag_magical_offensive,AE_mag_precision,AE_mag_enchanted,AE_mag_precision_offensive,AE_fut_ubiquitous,eoma_precision,eoma_enchanted,eoma_magical_offensive,eoma_magical_defensive,eoma_precision_offensive
				    [/not]
				    increase_parry=5
				[/effect]
				[effect]
				    apply_to=attack
				    range=ranged
				    special_id=magical,AE_mag_magical_defensive,AE_mag_magical_offensive,AE_mag_precision,AE_mag_enchanted,AE_mag_precision_offensive,AE_fut_ubiquitous,eoma_precision,eoma_enchanted,eoma_magical_offensive,eoma_magical_defensive,eoma_precision_offensive
				    [set_specials]
				    	mode=append
				    	[chance_to_hit]
							id=qquws_magical_fog
							sub=5
							name="mind fog"
							description="When this attack is used, opponent's magical chance to hit is reduced by 5%. Champions and the Butcher of Wesnoth are immune."
							apply_to=opponent
							cumulative=no
							[filter_opponent]
								[filter_weapon]
									special_id=magical,AE_mag_magical_defensive,AE_mag_magical_offensive,AE_mag_precision,AE_mag_enchanted,AE_mag_precision_offensive,AE_fut_ubiquitous,eoma_precision,eoma_enchanted,eoma_magical_offensive,eoma_magical_defensive,eoma_precision_offensive
								[/filter_weapon]

								[not]
									trait=immune_to_specials
								[/not]
							[/filter_opponent]
						[/chance_to_hit]
				    [/set_specials]
				[/effect]
			)}
		[/case]

		[case]
			value=M_DMG
			
			{AMLA_MOD_UNIT uws_amla_melee_dmg 3 20 "Melee dmg +8%" "icons/crossed_sword_and_hammer.png" (
				[effect]
				    apply_to=attack
				    range=melee
				    increase_damage=8%
				[/effect]
			)}
		[/case]

		[case]
			value=M_STR
			
			{AMLA_MOD_UNIT uws_amla_melee_strike_1 1 60 "Melee strike (defense)" "icons/crossed_sword_and_hammer.png" (
				[effect]
				    apply_to=attack
				    range=melee
				    [set_specials]
				    	mode=append
						[attacks]
							id=qquws_fast_reflex
							name="fast reflex"
							description="Adds 1 strike when defending."
							active_on=offense
							add=1
						[/attacks]
				    [/set_specials]
				[/effect]
			)}

			{AMLA_MOD_UNIT uws_amla_melee_strike_2 1 30 "Melee strike (always)" "icons/crossed_sword_and_hammer.png" (
				require_amla=uws_amla_melee_strike_1
				[effect]
				    apply_to=attack
				    range=melee
				    remove_specials=qquws_fast_reflex
				    increase_attacks=1
				[/effect]
			)}
		[/case]

		[case]
			value=M_MAG_ACC
			
			{AMLA_MOD_UNIT uws_amla_melee_mag_acc_1 1 40 "Melee magical 75%" "icons/crossed_sword_and_hammer.png" (
				[effect]
				    apply_to=attack
				    range=melee
				    special_id=magical
				    remove_specials=magical
				    [set_specials]
				    	mode=append
						[chance_to_hit]
					        id=magical
					        name="magical 75%"
					        description="This attack always has a 75% chance to hit regardless of the defensive ability of the unit being attacked."
					        value=75
					        cumulative=no
					    [/chance_to_hit]
				    [/set_specials]
				[/effect]
			)}

			{AMLA_MOD_UNIT uws_amla_melee_mag_acc_2 1 50 "Melee magical 80%" "icons/crossed_sword_and_hammer.png" (
				require_amla=uws_amla_melee_mag_acc_1
				[effect]
				    apply_to=attack
				    range=melee
				    special_id=magical
				    remove_specials=magical
				    [set_specials]
				    	mode=append
						[chance_to_hit]
					        id=magical
					        name="magical 80%"
					        description="This attack always has a 80% chance to hit regardless of the defensive ability of the unit being attacked."
					        value=80
					        cumulative=no
					    [/chance_to_hit]
				    [/set_specials]
				[/effect]
			)}

			{AMLA_MOD_UNIT uws_amla_melee_mag_acc_3 1 60 "Melee magical 85%" "icons/crossed_sword_and_hammer.png" (
				require_amla=uws_amla_melee_mag_acc_2
				[effect]
				    apply_to=attack
				    range=melee
				    special_id=magical
				    remove_specials=magical
				    [set_specials]
				    	mode=append
						[chance_to_hit]
					        id=magical
					        name="magical 85%"
					        description="This attack always has a 85% chance to hit regardless of the defensive ability of the unit being attacked."
					        value=85
					        cumulative=no
					    [/chance_to_hit]
				    [/set_specials]
				[/effect]
			)}
		[/case]

		[case]
			value=M_ACC
			
			{AMLA_MOD_UNIT uws_amla_melee_acc_1 1 16 "Melee accuracy +2%" "icons/crossed_sword_and_hammer.png" (
				[effect]
				    apply_to=attack
				    range=melee
				    [not]
				    	special_id=magical,AE_mag_magical_defensive,AE_mag_magical_offensive,AE_mag_precision,AE_mag_enchanted,AE_mag_precision_offensive,AE_fut_ubiquitous,eoma_precision,eoma_enchanted,eoma_magical_offensive,eoma_magical_defensive,eoma_precision_offensive
				    [/not]
				    increase_accuracy=2
				[/effect]
			)}

			{AMLA_MOD_UNIT uws_amla_melee_acc_2 1 24 "Melee accuracy +3%" "icons/crossed_sword_and_hammer.png" (
				require_amla=uws_amla_melee_acc_1
				[effect]
				    apply_to=attack
				    range=melee
				    [not]
				    	special_id=magical,AE_mag_magical_defensive,AE_mag_magical_offensive,AE_mag_precision,AE_mag_enchanted,AE_mag_precision_offensive,AE_fut_ubiquitous,eoma_precision,eoma_enchanted,eoma_magical_offensive,eoma_magical_defensive,eoma_precision_offensive
				    [/not]
				    increase_accuracy=3
				[/effect]
			)}
		[/case]

		[case]
			value=M_PAR
			
			{AMLA_MOD_UNIT uws_amla_melee_parry_1 1 10 "Melee parry +2%" "icons/crossed_sword_and_hammer.png" (
				[effect]
				    apply_to=attack
				    range=melee
				    [not]
				    	special_id=magical,AE_mag_magical_defensive,AE_mag_magical_offensive,AE_mag_precision,AE_mag_enchanted,AE_mag_precision_offensive,AE_fut_ubiquitous,eoma_precision,eoma_enchanted,eoma_magical_offensive,eoma_magical_defensive,eoma_precision_offensive
				    [/not]
				    increase_parry=2
				[/effect]
			)}

			{AMLA_MOD_UNIT uws_amla_melee_parry_2 1 15 "Melee parry +3%" "icons/crossed_sword_and_hammer.png" (
				require_amla=uws_amla_melee_parry_1
				[effect]
				    apply_to=attack
				    range=melee
				    [not]
				    	special_id=magical,AE_mag_magical_defensive,AE_mag_magical_offensive,AE_mag_precision,AE_mag_enchanted,AE_mag_precision_offensive,AE_fut_ubiquitous,eoma_precision,eoma_enchanted,eoma_magical_offensive,eoma_magical_defensive,eoma_precision_offensive
				    [/not]
				    increase_parry=3
				[/effect]
			)}
		[/case]

		[case]
			value=SMALL_SPEED
			
			{AMLA_MOD_UNIT uws_amla_small_speed 1 20 "Movement costs -1" "icons/boots_elven.png" (
				[effect]
				    apply_to=movement_costs
				    replace=no
				    [movement_costs]
						flat=-1
						frozen=-1
						forest=-1
						hills=-1
						mountains=-1
						village=-1
						swamp_water=-1
						shallow_water=-1
						deep_water=-1
						reef=-1
						castle=-1
						cave=-1
						sand=-1
						fungus=-1
				    [/movement_costs]
				[/effect]
			)}
		[/case]

		[case]
			value=SPEED
			
			# speed is always presented with small_speed due to the rules
			{AMLA_MOD_UNIT uws_amla_speed_2 1 30 "MP +1" "icons/boots_elven.png" (
				require_amla=uws_amla_small_speed
				[effect]
				    apply_to=movement
				    increase=1
				[/effect]
			)}
		[/case]

		[case]
			value=LOW_XP
			
			{AMLA_MOD_UNIT uws_amla_max_xp_reduction 1 -30 "" "icons/letter_and_ale.png" ()}
		[/case]

		[case]
			value=PHYS_RES
			
			{AMLA_MOD_UNIT uws_amla_phys_res 2 25 "Physical resistance +5%" "icons/shield_tower_merfolk.png" (
				[effect]
				    apply_to=resistance
				    replace=no
				    [resistance]
						blade=-5
						impact=-5
						pierce=-5
				    [/resistance]
				[/effect]
			)}
		[/case]

		[case]
			value=ARCANE_RES
			
			{AMLA_MOD_UNIT uws_amla_phys_res 2 20 "Arcane resistance +10%" "icons/skull_ring.png" (
				[effect]
				    apply_to=resistance
				    replace=no
				    [resistance]
						arcane=-10
				    [/resistance]
				[/effect]
			)}
		[/case]

		[case]
			value=NIGHT_EXTRA_DMG
			
			{AMLA_MOD_UNIT uws_amla_night_dmg_1 1 25 "Night damage +10% on offense" "icons/uws/cloak_black.png" (
				[effect]
				    apply_to=attack
				    remove_specials=qquws_evil_attack
				    [set_specials]
				    	mode=append
						[damage]
					        id=qquws_evil_attack
					        name="evil"
					        description="This attack deals additional 10% damage on offense when used at nighttime."
					        multiply=1.1
					        apply_to=self
					        active_on=offense
					        [filter_self]
					        	[filter_location]
					        		time_of_day=chaotic
					        	[/filter_location]
					        [/filter_self]
					    [/damage]
				    [/set_specials]
				[/effect]
			)}

			{AMLA_MOD_UNIT uws_amla_night_dmg_2 1 35 "Night damage +20% on offense" "icons/uws/cloak_black.png" (
				require_amla=uws_amla_night_dmg_1
				[effect]
				    apply_to=attack
				    remove_specials=qquws_evil_attack
				    [set_specials]
				    	mode=append
						[damage]
					        id=qquws_evil_attack
					        name="evil"
					        description="This attack deals additional 20% damage on offense when used at nighttime."
					        multiply=1.2
					        apply_to=self
					        active_on=offense
					        [filter_self]
					        	[filter_location]
					        		time_of_day=chaotic
					        	[/filter_location]
					        [/filter_self]
					    [/damage]
				    [/set_specials]
				[/effect]
			)}
		[/case]
	[/switch]
#enddef

#define AMLA_MOD_UNIT UWS_AMLA_ID MAX_TIMES XP_CHANGE DESCRIPTION IMAGE EFFECT_WML
	[modify_unit]
		[filter]
			id=$unit.id
		[/filter]

		[effect]
			apply_to=new_advancement
			replace=no
			[advancement]
				id={UWS_AMLA_ID}
				always_display=yes
				description={DESCRIPTION}"
Full heal
Max experience +"{XP_CHANGE}
				image={IMAGE}
				max_times={MAX_TIMES}
				strict_amla=yes
				major_amla=yes
				{EFFECT_WML}
				[effect]
					apply_to=hitpoints
					heal_full=yes
				[/effect]
				[effect]
					apply_to=max_experience
					increase={XP_CHANGE}
				[/effect]
				[effect]
		            apply_to=status
		            remove=poisoned
		        [/effect]
		        [effect]
		            apply_to=status
		            remove=slowed
		        [/effect]
			[/advancement]
		[/effect]
	[/modify_unit]
#enddef

#define ADD_DEFAULT_UWS_AMLA
	[modify_unit]
		[filter]
			id=$unit.id
		[/filter]

		[variables]
			has_uws_amla_defined=yes
		[/variables]

		[object]
			silent=yes

			[effect]
				apply_to=remove_advancement
				amlas=amla_default
			[/effect]
		[/object]

		[effect]
			apply_to=new_advancement
			replace=no
			[advancement]
				id=uws_default_amla
				always_display=no
				description="Max hp +8%
Full heal
Max experience +12%"
				image="icons/amla-default.png"
				max_times=-1
				strict_amla=yes
				major_amla=no
				[effect]
					apply_to=hitpoints
					heal_full=yes
					increase_total=8%
				[/effect]
				[effect]
					apply_to=max_experience
					increase=12%
				[/effect]
				[effect]
		            apply_to=status
		            remove=poisoned
		        [/effect]
		        [effect]
		            apply_to=status
		            remove=slowed
		        [/effect]
			[/advancement]
		[/effect]
	[/modify_unit]
#enddef
